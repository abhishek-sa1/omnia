{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Authentication Configuration",
    "type": "object",
    "properties": {
      "max_failures": {
        "type": "integer",
        "default": 3,
        "minimum": 3,
        "maximum": 3
      },
      "failure_reset_interval": {
        "type": "integer",
        "default": 60,
        "minimum": 30,
        "maximum": 60
      },
      "lockout_duration": {
        "type": "integer",
        "default": 10,
        "minimum": 5,
        "maximum": 10
      },
      "session_timeout": {
        "type": "integer",
        "default": 180,
        "minimum": 90,
        "maximum": 180
      },
      "alert_email_address": {
        "type": "string",
        "default": "",
        "format": "email"
      },
      "smtp_server": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "host": {
            "type": "string",
            "description": "SMTP server hostname or IP address",
            "minLength": 0
          },
          "port": {
            "type": "string",
            "description": "SMTP server port",
            "pattern": "^[0-9]*$",
            "minLength": 0
          },
          "sender_address": {
            "type": "string",
            "description": "Sender email address for alerts",
            "format": "email",
            "minLength": 0
          }
        },
        "anyOf": [
          {
            "properties": {
              "host": { "minLength": 1 },
              "port": { "minLength": 1 },
              "sender_address": { "minLength": 1 }
            },
            "required": ["host", "port", "sender_address"]
          },
          {
            "properties": {
              "host": { "minLength": 0 },
              "port": { "minLength": 0 },
              "sender_address": { "minLength": 0 }
            }
          }
        ]
      },
      "minItems": 1,
      "maxItems": 1,
      "description": "Array containing a single SMTP server configuration"
    },
      "user": {
        "type": "string",
        "default": "",
        "pattern": "^$|^((?!-)[a-zA-Z][a-zA-Z0-9-]*(?:@(?:25[0-5]|2[0-4][0-9]|1?[0-9]{1,2})(?:\\.(?:25[0-5]|2[0-4][0-9]|1?[0-9]{1,2})){3})?(\\s+|$))+$"
      },
      "allow_deny": {
        "type": "string",
        "enum": ["allow", "deny"],
        "default": "allow"
      },
      "restrict_program_support": {
        "type": "boolean",
        "default": false
      },
      "restrict_softwares": {
        "type": "string",
        "default": ""
      }
    },
    "required": [
      "max_failures"
    ]
  }

