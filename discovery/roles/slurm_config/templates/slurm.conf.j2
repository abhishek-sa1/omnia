ClusterName={{ cluster_name }}
{% for ctld in ctld_list %}
SlurmctldHost={{ ctld }}
{% endfor %}
{% if slurm_installation_type == configless_slurm  %}
{% set slurm_ctld_parameters = (slurm_ctld_parameters | default([]) ) + ['enable_configless'] %}
{% endif %}
{% if slurm_ctld_parameters | length > 0 %}
SlurmctldParameters={{ slurm_ctld_parameters | join(',') }}
{% endif %}
PluginDir={{ installroot }}{{ plugin_slurm_dir }}
{% for key in slurm_conf_dict | sort %}
{% set val = slurm_conf_dict[key] %}
{% if val is not none and val != omit %}
{{ key }}={{ 'yes' if val is sameas true else ('no' if val is sameas false else val) }}
{% endif %}
{% endfor %}

# SLURM DBD
{% if dbd_list %}
AccountingStorageHost={{ dbd_list[0] }}
AccountingStoragePort={{ slurm_dbd_port }}
AccountingStorageType=accounting_storage/slurmdbd
{% endif %}

# COMPUTE NODES
NodeName=DEFAULT State=UNKNOWN
# TODO: Default case no compute nodes to be handled
{% for cmpt in (cmpt_list | default([])) %}
NodeName={{ cmpt }} # TODO: Other params
{% endfor %}
{% for login in (login_list | default([])) %}
NodeName={{ login }}
{% endfor %}

# PARTITION INFO
PartitionName=DEFAULT Nodes=ALL Default=YES MaxTime=INFINITE State=UP
{% if cmpt_list %}
PartitionName={{ slurm_partition_name }} Nodes={{ cmpt_list | join(',') }} MaxTime=INFINITE State=UP
{% endif %}
{% for i in partitions %}
PartitionName={{ i.PartitionName }}{% for k in i | sort if k != 'PartitionName' %} {{ k }}={{ 'YES' if i[k] is sameas true else ('NO' if i[k] is sameas false else i[k]) }}{% endfor %}
{% endfor %}
