# Copyright 2025 Dell Inc. or its subsidiaries. All Rights Reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
---

# Kubernetes config root
kube_config_root: "/root/k8s/{{ hostvars['localhost']['k8s_version'] }}/kube_node_configs"

# Subdirectories
kube_config_dir: "kubernetes"
kube_ssl_dir: "kubernetes/ssl"
cni_dir: "cni"
local_bin_dir: "usr/local/bin"

# Certificates
kube_ca_cert_src: "/etc/kubernetes/ssl/ca.crt"
pulp_webserver_cert_src: "/etc/pki/ca-trust/source/anchors/pulp_webserver.crt"

# CNI
cni_bin_src: "/opt/cni/bin/"

# Containerd
containerd_conf_src: "/etc/containerd"
containerd_service_src: "/etc/systemd/system/containerd.service"
kubelet_service_src: "/etc/systemd/system/kubelet.service"

# Binaries to copy
kube_binaries:
  - /usr/local/bin/calicoctl
  - /usr/local/bin/calicoctl.sh
  - /usr/local/bin/containerd
  - /usr/local/bin/containerd-shim-runc-v2
  - /usr/local/bin/containerd-stress
  - /usr/local/bin/crictl
  - /usr/local/bin/ctr
  - /usr/local/bin/etcdctl
  - /usr/local/bin/kubeadm
  - /usr/local/bin/kubelet
  - /usr/local/bin/kubernetes-scripts
  - /usr/local/bin/nerdctl
  - /usr/local/bin/runc

# NFS
nfs_package: "nfs-utils"
nfs_server_ip: "{{ hostvars['localhost']['matched_nfs'].server_ip }}"
nfs_server_share_path: "{{ hostvars['localhost']['matched_nfs'].server_share_path }}"
nfs_client_share_path: "{{ hostvars['localhost']['matched_nfs'].client_share_path }}"
nfs_client_mount_options: "{{ hostvars['localhost']['matched_nfs'].client_mount_options | default('rw,sync,hard,intr') }}"

# Cloud-init
cloud_init_template: "cloud-init-vars.j2"
kubeadm_join_template: "kubeadm_join_vars.j2"
cloud_init_output: "/opt/omnia/kubespray/cloud-init-vars.yaml"
kubeadm_output: "/opt/omnia/kubespray/kubeadm_join_vars.yaml"

# vars/main.yml
kube_proxy_namespace: "kube-system"
kube_proxy_configmap: "kube-proxy"
kube_proxy_temp_file: "/tmp/kube-proxy-cm.yaml"
kube_proxy_label_selector: "k8s-app=kube-proxy"
